# ๐ง ุฏููู ุงูุจุญุซ ุงูุฐูู (Smart Search)

## ูุธุฑุฉ ุนุงูุฉ

ูุธุงู ุงูุจุญุซ ุงูุฐูู ูู ููุฒุฉ ุฌุฏูุฏุฉ ุชุฌุนู ุงูุจุญุซ ุนู ุงูููุชุฌุงุช ูู ุดุงุดุฉ ุฅูุดุงุก ุงููุงุชูุฑุฉ ุฃูุซุฑ ุฐูุงุกู ูู ุฎูุงู:

1. **ููู ุณูุงู ุงููุงุชูุฑุฉ**: ุฅุฐุง ุฃุถูุช ููุชุฌ "ููุงุฑ"ุ ุณุชุธูุฑ ููุชุฌุงุช "ููุงุฑ" ุฃููุงู
2. **ุชุนูู ุชูุถููุงุช ุงูุนููู**: ุงููุธุงู ูุชุฐูุฑ ูุงุฐุง ูุดุชุฑู ูู ุนููู ุนุงุฏุฉู
3. **ุชุนูู ุชูุถููุงุช ุงูููุฑููุจ**: ุฅุฐุง ูุงู ุงูููุฑููุจ ููุถู ุนูุงูุฉ ูุนููุฉ
4. **ููู ุงูููุชุฌุงุช ุงููุฑุชุจุทุฉ**: ุงูููุชุฌุงุช ุงูุชู ุชูุดุชุฑู ูุนุงู ุนุงุฏุฉู
5. **๐ ุงููุธุงู ุงููุฌูู**: ุงูุชุดุงู ุงููุงุฑูุงุช ุชููุงุฆูุงู + ูุทุงุจูุฉ ุงููููุฉ ุงูุฃุฎูุฑุฉ

---

## ๐ ุงููุธุงู ุงููุฌูู (Hybrid Brand Detection)

ุงููุธุงู ุงูุฌุฏูุฏ ูุฌูุน ุจูู ุซูุงุซ ุทุฑู ูุงูุชุดุงู ุงููุงุฑูุงุช:

### 1. ุงููุงุฆูุฉ ุงูุซุงุจุชุฉ (Known Brands)
ูุงุฆูุฉ ูุญุฏุฏุฉ ูุณุจูุงู ูู ุงููุงุฑูุงุช ุงููุนุฑููุฉ (ููุงุฑุ ุณูููุฒุ ุจุงูุงุณููููุ ุฅูุฎ).

### 2. ุงูุงูุชุดุงู ุงูุชููุงุฆู (Auto-Discovery)
ุนูุฏ ุงูุชุฏุฑูุจุ ุงููุธุงู ูุญูู ุฃุณูุงุก ุฌููุน ุงูููุชุฌุงุช ูููุชุดู ุงููููุงุช ุงูุฃุฎูุฑุฉ ุงูุชู ุชุชูุฑุฑ ูู 5+ ููุชุฌุงุช.

**ูุซุงู:**
```
ุงูููุชุฌุงุช:
- ุณููุชุด 13A ููุฑูู
- ุณููุชุด 45A ููุฑูู  
- ุจุฑูุฒุฉ ุฏุจู ููุฑูู
- ุณููุช ุฏุด ููุฑูู
- ุจูุงู ุณููุชุด ููุฑูู
- ุจุฑูุฒุฉ ุชูููู ููุฑูู

ุงููุธุงู ููุชุดู: "ููุฑูู" ุชุธูุฑ ูู 6 ููุชุฌุงุช โ ูุงุฑูุฉ ููุชุดูุฉ ุชููุงุฆูุงู โ
```

### 3. ูุทุงุจูุฉ ุงููููุฉ ุงูุฃุฎูุฑุฉ (Last Word Matching)
ุนูุฏ ุงุฎุชูุงุฑ ููุชุฌุ ุงููุธุงู ูุณุชุฎุฑุฌ ุงููููุฉ ุงูุฃุฎูุฑุฉ ููุนุทู ููุงูุฃุฉ ููููุชุฌุงุช ุงูุชู ุชูุชูู ุจููุณ ุงููููุฉ.

**ูุซุงู:**
```
ุงุฎุชุฑุช: "ุณููุชุด 13A ููุฑูู"
โ
ุงููููุฉ ุงูุฃุฎูุฑุฉ: "ููุฑูู"
โ
ุนูุฏ ุงูุจุญุซ ุนู "ุณููุช":
  1. ุณููุช ุฏุด ููุฑูู โญ (+45 ููุทุฉ - ููุณ ุงููููุฉ ุงูุฃุฎูุฑุฉ)
  2. ุณููุช ุฏุด ููุงุฑ (0 ููุงุท)
```

---

## ุฃูุงูู ุงุณุชุฎุฏุงู ุงูุจุญุซ ุงูุฐูู

ุงูุจุญุซ ุงูุฐูู ูุนูู ูู **ุฌููุน** ุฃูุงูู ุงูุจุญุซ ุนู ุงูููุชุฌุงุช:

### 1. ุดุงุดุฉ ุฅูุดุงุก ุงููุงุชูุฑุฉ
- โ **ุญูู ุงูุจุญุซ ุงูุนููู** ("ุงูุจุญุซ ุนู ุตูู")
- โ **ุนููุฏ ุงูุชูุงุตูู** ูู ุฌุฏูู ุงูุฃุตูุงู (Autocomplete ุฏุงุฎู ูู ุตู)
- โ **ููุญุฉ ุงูุชุณููุฉ** (ุงูุจุญุซ ุจุงูู ID ูุงูุงุณู)
- โ **Dialog ุฅุถุงูุฉ ุชุณููุฉ**

### 2. ุดุงุดุฉ ุชุนุฏูู ุงูููุงุชูุฑ
- โ **Dialog ุงูุชุณููุฉ**

---

## ููููุฉ ุงูุชูุนูู

### ุงูุฎุทูุฉ 1: ุงูุชุฏุฑูุจ ุงูุฃููู

1. ุงูุชุญ ุงูุชุทุจูู
2. ุงุฐูุจ ุฅูู **ุงูุฅุนุฏุงุฏุงุช ุงูุนุงูุฉ**
3. ุงุจุญุซ ุนู ูุณู **ุงูุจุญุซ ุงูุฐูู (AI)**
4. ุงุถุบุท ุนูู **ุชุฏุฑูุจ ุงูุจุญุซ ุงูุฐูู**
5. ุงูุชุธุฑ ุญุชู ููุชูู ุงูุชุฏุฑูุจ (ุนุงุฏุฉู 5-30 ุซุงููุฉ)

### ุงูุฎุทูุฉ 2: ุงูุงุณุชุฎุฏุงู

ุจุนุฏ ุงูุชุฏุฑูุจุ ุณูุนูู ุงูุจุญุซ ุงูุฐูู ุชููุงุฆูุงู ูู ุดุงุดุฉ ุฅูุดุงุก ุงููุงุชูุฑุฉ.

---

## ููู ูุนููุ

### 1. Session Context (ุณูุงู ุงูุฌูุณุฉ)

ุนูุฏ ุฅุถุงูุฉ ุฃูู ููุชุฌ ูููุงุชูุฑุฉุ ุงููุธุงู ูุณุชุฎุฑุฌ ุงูุนูุงูุฉ ุงูุชุฌุงุฑูุฉ **ูุงููููุฉ ุงูุฃุฎูุฑุฉ** ููุนุทู ุฃููููุฉ ููููุชุฌุงุช ุงููุดุงุจูุฉ.

**ูุซุงู:**
```
ุฃุถูุช: "ุณููุชุด 1 ุฎุท ูููููุงุฑ"
โ
ุงููุธุงู ูููู: 
  - ุงูุนูุงูุฉ = "ููุงุฑ" (ูู ุงููุงุฆูุฉ ุงูุซุงุจุชุฉ)
  - ุงููููุฉ ุงูุฃุฎูุฑุฉ = "ูููููุงุฑ"
โ
ุนูุฏ ุงูุจุญุซ ุนู "ุณููุชุด 2":
  1. ุณููุชุด 2 ุฎุท ูููููุงุฑ โญ (+50 ูุงุฑูุฉ + 45 ูููุฉ ุฃุฎูุฑุฉ = 95 ููุทุฉ)
  2. ุณููุชุด 2 ุฎุท ููุงุฑ (+50 ูุงุฑูุฉ ููุท)
  3. ุณููุชุด 2 ุฎุท ุจุงูุงุณูููู (0 ููุงุท)
```

### 2. Customer Preferences (ุชูุถููุงุช ุงูุนููู)

ุงููุธุงู ูุชุนูู ูู ุงูููุงุชูุฑ ุงูุณุงุจูุฉ ูุงุฐุง ูุดุชุฑู ูู ุนููู.

**ูุซุงู:**
```
ุงูุนููู "ูุคุณุณุฉ ุงูููุฑ":
  - 80% ูู ูุดุชุฑูุงุชู "ููุงุฑ"
  - 15% "ุจุงูุงุณูููู"
  - 5% ุฃุฎุฑู

ุนูุฏ ูุชุญ ูุงุชูุฑุฉ ููุฐุง ุงูุนููู:
  โ ููุชุฌุงุช "ููุงุฑ" ุชุญุตู ุนูู +40 ููุทุฉ ุชููุงุฆูุงู
```

### 3. Installer Preferences (ุชูุถููุงุช ุงูููุฑููุจ)

ุฅุฐุง ูุงู ุงูุนููู ุฌุฏูุฏุงู ููู ุงูููุฑููุจ ูุนุฑููุ ุงููุธุงู ูุณุชุฎุฏู ุชูุถููุงุช ุงูููุฑููุจ.

**ูุซุงู:**
```
ุงูููุฑููุจ "ุฃุจู ุนูู":
  - 90% ูู ููุงุชูุฑู "ููุงุฑ"

ุนููู ุฌุฏูุฏ + ุงูููุฑููุจ "ุฃุจู ุนูู":
  โ ููุชุฌุงุช "ููุงุฑ" ุชุญุตู ุนูู ุฃููููุฉ
```

### 4. Product Associations (ุงูููุชุฌุงุช ุงููุฑุชุจุทุฉ)

ุงููุธุงู ูุชุนูู ุฃู ููุชุฌุงุช ุชูุดุชุฑู ูุนุงู ุนุงุฏุฉู.

**ูุซุงู:**
```
ูู 370 ูุงุชูุฑุฉุ ุงููุธุงู ุชุนูู:
  - "ููุจู 2.5" ููุดุชุฑู ูุน "ููุจู 1.5" (95% ูู ุงูุญุงูุงุช)
  - "ุณููุชุด 1" ููุดุชุฑู ูุน "ุณููุชุด 2" (98% ูู ุงูุญุงูุงุช)
  - "ููุจู" ูุงุฏุฑุงู ููุดุชุฑู ูุน "ุณููุชุด" (15% ููุท)

ุนูุฏ ุฅุถุงูุฉ "ููุจู 2.5" ูุงูุจุญุซ:
  โ "ููุจู 1.5" ูุญุตู ุนูู +35 ููุทุฉ
  โ "ุจููุณ ุญุฏูุฏ" ูุญุตู ุนูู +30 ููุทุฉ
  โ "ุณููุชุด" ูุญุตู ุนูู +5 ููุงุท ููุท
```

---

## ุงูุจููุฉ ุงูุชูููุฉ

```
lib/services/smart_search/
โโโ smart_search.dart           # ููู ุงูุชุตุฏูุฑ
โโโ smart_search_models.dart    # ุงูููุงุฐุฌ
โโโ smart_search_db.dart        # ูุงุนุฏุฉ ุจูุงูุงุช ูููุตูุฉ
โโโ smart_search_trainer.dart   # ุงูุชุฏุฑูุจ
โโโ smart_search_service.dart   # ุงูุฎุฏูุฉ ุงูุฑุฆูุณูุฉ
```

### ูุงุนุฏุฉ ุงูุจูุงูุงุช

ูุงุนุฏุฉ ุจูุงูุงุช ูููุตูุฉ (`smart_search.db`) ุชุญุชูู:

1. **product_associations**: ุนูุงูุงุช ุงูููุชุฌุงุช
2. **customer_brand_preferences**: ุชูุถููุงุช ุงูุนููุงุก
3. **installer_brand_preferences**: ุชูุถููุงุช ุงูููุฑููุจูู
4. **discovered_brands**: ุงูุนูุงูุงุช ุงูุชุฌุงุฑูุฉ ุงูููุชุดูุฉ
5. **training_stats**: ุฅุญุตุงุฆูุงุช ุงูุชุฏุฑูุจ

---

## ุงูุชุนูู ุงููุณุชูุฑ

ุงููุธุงู ูุชุนูู ุชููุงุฆูุงู ูุน ูู ูุงุชูุฑุฉ ุฌุฏูุฏุฉ:

1. ุนูุฏ ุญูุธ ูุงุชูุฑุฉ โ ููุญุฏูุซ ุงูุนูุงูุงุช ูุงูุชูุถููุงุช
2. ูุง ุญุงุฌุฉ ูุฅุนุงุฏุฉ ุงูุชุฏุฑูุจ ุงููุงูู
3. ุงููุธุงู ูุตุจุญ ุฃุฐูู ูุน ุงูููุช

---

## ุงูุฃุณุฆูุฉ ุงูุดุงุฆุนุฉ

### ูู ูุคุซุฑ ุนูู ุณุฑุนุฉ ุงูุจุญุซุ
ูุงุ ุงูุจุญุซ ูุจูู ุณุฑูุนุงู (< 50ms) ูุฃู:
- FTS5 ูุฌูุจ ุงููุชุงุฆุฌ ุฃููุงู
- ุซู ูุชู ุฅุนุงุฏุฉ ุชุฑุชูุจูุง ููุท

### ูุงุฐุง ูู ุญุฐูุช ูุงุนุฏุฉ ุจูุงูุงุช ุงูุจุญุซ ุงูุฐููุ
ุงูุชุทุจูู ูุนูู ุจุดูู ุทุจูุนู ููุฑุฌุน ููุจุญุซ ุงูุนุงุฏู.

### ูู ูููู ุชุนุทูู ุงูุจุญุซ ุงูุฐููุ
ูุนูุ ูููู ุชุนุทููู ุจุฑูุฌูุงู:
```dart
SmartSearchService.instance.setEnabled(false);
```

### ูู ูุฑุฉ ูุฌุจ ุฅุนุงุฏุฉ ุงูุชุฏุฑูุจุ
- ุงูุชุฏุฑูุจ ุงูุฃููู: ูุฑุฉ ูุงุญุฏุฉ
- ุงูุชุนูู ุงููุณุชูุฑ: ุชููุงุฆู ูุน ูู ูุงุชูุฑุฉ
- ุฅุนุงุฏุฉ ุงูุชุฏุฑูุจ ุงููุงูู: ููุท ุฅุฐุง ุฃุฑุฏุช ุงูุจุฏุก ูู ุฌุฏูุฏ

---

## ุงูุนูุงูุงุช ุงูุชุฌุงุฑูุฉ ุงููุฏุนููุฉ

### ๐ ุงูุงูุชุดุงู ุงูุชููุงุฆู
ุงููุธุงู ููุชุดู ุงููุงุฑูุงุช ุชููุงุฆูุงู ูู ุฃุณูุงุก ุงูููุชุฌุงุช ุนูุฏ ุงูุชุฏุฑูุจ:
- ุฃู ูููุฉ ุฃุฎูุฑุฉ ุชุธูุฑ ูู **5 ููุชุฌุงุช ุฃู ุฃูุซุฑ** ุชูุนุชุจุฑ ูุงุฑูุฉ
- ูุชู ุญูุธูุง ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุงุณุชุฎุฏุงููุง ูู ุงูุจุญุซ
- ูุง ุญุงุฌุฉ ูุชุญุฏูุซ ุงููุงุฆูุฉ ูุฏููุงู ุนูุฏ ุฅุถุงูุฉ ูุงุฑูุงุช ุฌุฏูุฏุฉ

### ุงููุงุฆูุฉ ุงูุซุงุจุชุฉ (ูููุงุฑูุงุช ุงููุนุฑููุฉ)

#### ุงูุนูุงูุงุช ุงูุนุงูููุฉ:
- ููุงุฑ / ููู ููุงุฑ / ูููููุงุฑ
- ุณูููุฒ / ุณูููุณ (Siemens)
- ุจุงูุงุณูููู (Panasonic)
- ูุงุดููุงู (National)
- ุดูุงูุฏุฑ (Schneider)
- ููุฌุฑุงูุฏ (Legrand)
- ABB
- ุชูุดูุจุง (Toshiba)
- ููููุจุณ (Philips)
- ุงูุณุฑุงู (Osram)
- ุฌูุฑุงู (General)
- LG
- ุณุงูุณููุฌ (Samsung)

### ุงูุนูุงูุงุช ุงููุญููุฉ/ุงูุฅูููููุฉ:
- ููุฑูู
- ุจูุฑูู (Perylli)
- ุฃุณูุง / ุงุณูุง (Asia)
- ุงูุชุฑุง (Ultra)
- ุชุจููู
- ุงูุฌุง
- ุฑุงููู (Ramco)
- ุฌุงู
- OTG
- ES
- BG

### ุนูุงูุงุช ุงูููุดุฃ:
- ุงุฑุฏูู
- ุงูุทุงููุงูู
- ููููุฏู
- ุงููุงูู

### ๐ ุฃูุฒุงู ุงูุชุฑุฌูุญ (ุงููุธุงู ุงูุฌุฏูุฏ - Re-ranking)

ุงููุธุงู ุงูุฌุฏูุฏ ูุง ูุณุชุฎุฏู ููุงุท ุนุดูุงุฆูุฉุ ุจู ููุนูุฏ ุชุฑุชูุจ ุงููุชุงุฆุฌ ุจูุงุกู ุนูู ุงููุฌููุนุงุช:

| ุงูุฃููููุฉ | ุงููุฌููุนุฉ | ุงููุตู |
|----------|----------|-------|
| 1 | ุงูุจุญุซ + ุงูุณูุงู | ุงูููุชุฌุงุช ุงูุชู ุชุทุงุจู ูููุงุช ุงูุจุญุซ + ุงููุงุฑูุฉ ุงููุฎุชุงุฑุฉ |
| 2 | ุงูุจุญุซ ููุท | ุงูููุชุฌุงุช ุงูุชู ุชุทุงุจู ูููุงุช ุงูุจุญุซ (ุชุฑุชูุจ FTS5) |
| 3 | ุงูุณูุงู ููุท | ุงูููุชุฌุงุช ุงูุชู ุชุทุงุจู ุงููุงุฑูุฉ ุงููุฎุชุงุฑุฉ |
| 4 | ุจุงูู ุงููุชุงุฆุฌ | ูุชุงุฆุฌ FTS5 ุงูุฌุฒุฆูุฉ |

**ุฏุงุฎู ูู ูุฌููุนุฉ:** ุงูููุชุฌุงุช ุงูุฃูุซุฑ ุงุฑุชุจุงุทุงู (ูู Product Associations) ุชุธูุฑ ุฃููุงู.

**ูุซุงู:**
```
ุงูุจุญุซ = "ุณููุฌ ููู"
ุงูุณูุงู = "ููุฑูู"
ุงูููุชุฌ ุงููุฎุชุงุฑ = "ุณููุชุด 1 ุฎุท ููุฑูู"

ุงูุชุฑุชูุจ:
1. ุณููุฌ ููู ููุฑูู โ ูุทุงุจู ุงูุจุญุซ + ุงูุณูุงู
2. ุณููุฌ ููู ููุงุฑ โ ูุทุงุจู ุงูุจุญุซ ููุท
3. ุณููุฌ ููุฑูู โ ูุทุงุจู ุงูุณูุงู ููุท
4. ุณููุฌ ููุงุฑ โ ุจุงูู ุงููุชุงุฆุฌ
```

**ูุซุงู ุขุฎุฑ (ูุน Associations):**
```
ุงูุจุญุซ = "ุณููุชุด"
ุงูููุชุฌ ุงููุฎุชุงุฑ = "ุณููุชุด 1 ุฎุท ููุฑูู"
ูู ุงูุชุฏุฑูุจ: "ุณููุชุด 2 ุฎุท ููุฑูู" ููุดุชุฑู ูุน "ุณููุชุด 1 ุฎุท ููุฑูู" ูู 95% ูู ุงูููุงุชูุฑ

ุงูุชุฑุชูุจ ุฏุงุฎู ุงููุฌููุนุฉ 1 (ุจุญุซ + ุณูุงู):
1. ุณููุชุด 2 ุฎุท ููุฑูู โ ุงูุฃูุซุฑ ุงุฑุชุจุงุทุงู โญ
2. ุณููุชุด 3 ุฎุท ููุฑูู โ ุฃูู ุงุฑุชุจุงุทุงู
3. ุจุฑูุฒุฉ ููุฑูู โ ุจุฏูู ุงุฑุชุจุงุท (ุชุฑุชูุจ FTS5)
```

### ๐ ุงููููุงุช ุงููุณุชุจุนุฏุฉ (Excluded Words)

ุงููุธุงู ูุชุฌุงูู ุงููููุงุช ุงูุนุงูุฉ/ุงููุตููุฉ ุชููุงุฆูุงู ูุซู:
- **ุงูุฃูุตุงู:** ุฌุฏูุฏุ ุฃุตููุ ุซูููุ ูุจูุฑุ ููุชุงุฒ
- **ุงูุฃููุงู:** ุงุจูุถุ ุงุณูุฏุ ุงุญูุฑุ ุงุฒุฑู
- **ุงููุญุฏุงุช:** ูููุ ุณูุ ูุชุฑุ ุงูุจูุฑุ ูููุช
- **ุงูููุงุฏ:** ุญุฏูุฏุ ูุญุงุณุ ุจูุงุณุชููุ ุฎุดุจ

ูุฐุง ูููุน ุชุนูู ูููุงุช ุฎุงุทุฆุฉ ููุงุฑูุงุช.

ูููู ุฅุถุงูุฉ ุงููุฒูุฏ ูู ุงููุงุฑูุงุช ุงูุซุงุจุชุฉ ูู `smart_search_models.dart` โ ุฏุงูุฉ `extractBrand()`.
