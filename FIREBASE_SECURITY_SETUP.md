# ๐ ุฅุนุฏุงุฏ ุญูุงูุฉ Firebase - Security Rules

## ุงูุฎุทูุฉ 1: ุชูุนูู Anonymous Authentication

1. ุงุฐูุจ ุฅูู [Firebase Console](https://console.firebase.google.com/)
2. ุงุฎุชุฑ ูุดุฑูุนู: `debt-book-app-d7e74`
3. ูู ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ: **Build** โ **Authentication**
4. ุงุถุบุท ุนูู **Get started** (ุฅุฐุง ูู ุชูุนูู ูู ูุจู)
5. ุงุฐูุจ ุฅูู ุชุจููุจ **Sign-in method**
6. ุงุถุบุท ุนูู **Anonymous**
7. ูุนูู ุงูุฎูุงุฑ **Enable**
8. ุงุถุบุท **Save**

โ ุงูุขู ูู ุฌูุงุฒ ูุณุชุฎุฏู ุงูุชุทุจูู ุณูุญุตู ุนูู ูููุฉ ูุฑูุฏุฉ (UID)

---

## ุงูุฎุทูุฉ 2: ุฅุนุฏุงุฏ Firestore Security Rules

1. ูู ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ: **Build** โ **Firestore Database**
2. ุงุถุบุท ุนูู ุชุจููุจ **Rules**
3. **ุงุญุฐู** ุงูููุงุนุฏ ุงูุญุงููุฉ
4. **ุงูุณุฎ ูุงูุตู** ุงูููุงุนุฏ ุงูุชุงููุฉ:

```javascript
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    
    // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    // ููุงุนุฏ ุญูุงูุฉ ูุฌููุนุงุช ุงููุฒุงููุฉ
    // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    
    match /sync_groups/{groupId} {
      // ุงูุณูุงุญ ููุท ูููุณุชุฎุฏููู ุงููุตุงุฏู ุนูููู
      allow read, write: if request.auth != null;
      
      // ุงูุนููุงุก
      match /customers/{customerId} {
        allow read, write: if request.auth != null;
      }
      
      // ุงููุนุงููุงุช
      match /transactions/{transactionId} {
        allow read, write: if request.auth != null;
      }
    }
    
    // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    // ููุน ุงููุตูู ูุฃู ูุณุงุฑ ุขุฎุฑ
    // โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
    match /{document=**} {
      allow read, write: if false;
    }
  }
}
```

5. ุงุถุบุท **Publish**

---

## โ ูุงุฐุง ุชูุนู ูุฐู ุงูููุงุนุฏุ

| ุงููุงุนุฏุฉ | ุงูุดุฑุญ |
|---------|-------|
| `request.auth != null` | ููุท ุงููุณุชุฎุฏููู ุงููุตุงุฏู ุนูููู (ูู ุชุทุจููู) |
| `match /sync_groups/{groupId}` | ุงููุตูู ููุฌููุนุงุช ุงููุฒุงููุฉ ููุท |
| `allow read, write: if false` | ููุน ุงููุตูู ูุฃู ุดูุก ุขุฎุฑ |

---

## ๐ก๏ธ ูุณุชูู ุงูุญูุงูุฉ

### ูุง ูู ูุญูู ุงูุขู:
- โ ููุท ุชุทุจููู ูุณุชุทูุน ุงููุตูู (ุนุจุฑ Anonymous Auth)
- โ ูุง ูููู ูุฃู ุดุฎุต ุฎุงุฑุฌู ูุฑุงุกุฉ ุงูุจูุงูุงุช
- โ ูุง ูููู ูุฃู ุดุฎุต ุฎุงุฑุฌู ุชุนุฏูู ุงูุจูุงูุงุช
- โ ูู ุฌูุงุฒ ูู ูููุฉ ูุฑูุฏุฉ (UID)

### ูุง ูุง ูุฒุงู ููููุงู (ูุธุฑูุงู):
- โ๏ธ ุฅุฐุง ุญุตู ุดุฎุต ุนูู ุงูู API Key + ุฃูุดุฃ ุชุทุจูู ูุฒูู
- โ๏ธ ููู ูุฐุง ูุชุทูุจ ูุนุฑูุฉ ุชูููุฉ ุนุงููุฉ ุฌุฏุงู

---

## ๐ ุญูุงูุฉ ุฅุถุงููุฉ (ุงุฎุชูุงุฑู - ูููุณุชูุจู)

### ุงูุฎูุงุฑ 1: ุชูููุฏ ุจู UID ูุญุฏุฏ
ุฅุฐุง ุฃุฑุฏุช ุงูุณูุงุญ ููุท ูุฃุฌูุฒุฉ ูุนููุฉ:

```javascript
// ูุงุฆูุฉ ุงูุฃุฌูุฒุฉ ุงููุณููุญ ุจูุง
function isAllowedDevice() {
  return request.auth.uid in [
    'UID_DEVICE_1',
    'UID_DEVICE_2',
    'UID_DEVICE_3',
    'UID_DEVICE_4'
  ];
}

match /sync_groups/{groupId}/{document=**} {
  allow read, write: if request.auth != null && isAllowedDevice();
}
```

### ุงูุฎูุงุฑ 2: ุชูููุฏ ุจุงููุฌููุนุฉ
```javascript
match /sync_groups/{groupId}/{document=**} {
  // ุงูุณูุงุญ ููุท ูููุฌููุนุงุช A ู B
  allow read, write: if request.auth != null 
    && groupId in ['group_a', 'group_b'];
}
```

---

## ๐ฑ ููู ุชุนุฑู UID ูู ุฌูุงุฒุ

ุจุนุฏ ุชุดุบูู ุงูุชุทุจูู ุนูู ูู ุฌูุงุฒุ ุณุชุฌุฏ ูู ุงูู Console:
```
โ ุชู ุชุณุฌูู ุงูุฏุฎูู ุงููุฌููู: abc123xyz...
```

ูุฐุง ูู ุงูู UID ุงููุฑูุฏ ููู ุฌูุงุฒ.

---

## โ๏ธ ููุงุญุธุงุช ูููุฉ

1. **ูุง ุชุดุงุฑู ุงูู UID** - ูู ูููุฉ ุงูุฌูุงุฒ
2. **ุงูู UID ูุจูู ุซุงุจุชุงู** - ุญุชู ุจุนุฏ ุฅุนุงุฏุฉ ุชุดุบูู ุงูุชุทุจูู
3. **ุฅุฐุง ุญุฐูุช ุงูุชุทุจูู** - ุณูุญุตู ุนูู UID ุฌุฏูุฏ
4. **ุงูููุงุนุฏ ุชูุทุจู ููุฑุงู** - ุจุนุฏ ุงูุถุบุท ุนูู Publish

---

## ๐งช ุงุฎุชุจุงุฑ ุงูุญูุงูุฉ

ุจุนุฏ ุฅุนุฏุงุฏ ุงูููุงุนุฏุ ุฌุฑุจ:

1. ุงูุชุญ ุงูุชุทุจูู - ูุฌุจ ุฃู ูุนูู ุจุดูู ุทุจูุนู
2. ุฌุฑุจ ุงููุตูู ูู ุงููุชุตูุญ ูุจุงุดุฑุฉ - ูุฌุจ ุฃู ููุฑูุถ

ููุงุฎุชุจุงุฑ ูู ุงููุชุตูุญ:
```
https://console.firebase.google.com/project/debt-book-app-d7e74/firestore/data
```

ุฅุฐุง ุญุงููุช ุงููุฑุงุกุฉ ุจุฏูู ูุตุงุฏูุฉุ ุณุชุฑู ุฎุทุฃ "Permission denied".

---

## โ ุงูุฎูุงุตุฉ

ุจุนุฏ ุชุทุจูู ูุฐู ุงูุฎุทูุงุช:
- ๐ ุจูุงูุงุชู ูุญููุฉ ุจุงููุตุงุฏูุฉ
- ๐ก๏ธ ููุท ุชุทุจููู ูุณุชุทูุน ุงููุตูู
- ๐ฐ ุฃููุงู ุงููุงุณ ูู ุฃูุงู
