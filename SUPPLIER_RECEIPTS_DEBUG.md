# ุฏููู ุชุดุฎูุต ูุดููุฉ ุณูุฏุงุช ุงููุจุถ

## ุงููุดุงูู ุงููุจูุบ ุนููุง:
1. โ **ููุงุชูุฑ ุงูููุฏ**: ูุฌุจ ุฃู ุชุธูุฑ ุงููุจูุบ ุงููุนูู ูุน ูุต "ูุงุชูุฑุฉ ูุดุชุฑูุงุช ููุฏ"
2. โ **ููุงุชูุฑ ุงูุฏูู**: ูุฌุจ ุฃู ุชุธูุฑ ุงููุจูุบ ุงููุนูู ูุน ูุต "ูุงุชูุฑุฉ ูุดุชุฑูุงุช ุขุฌู"
3. โ **ุงูุฑุตูุฏ ุจุนุฏ ุงููุนุงููุฉ**: ูุธูุฑ ููุณ ุงูุฑุตูุฏ ุงูููุงุฆู ููู ุงูููุงุชูุฑ ุจุฏูุงู ูู ุงูุฑุตูุฏ ุงูุชุฏุฑูุฌู
4. โ **ุณูุฏุงุช ุงููุจุถ**: ูุง ุชุธูุฑ ูู ุณุฌู ุงููุนุงููุงุช

## ุงูุชุนุฏููุงุช ุงูุชู ุชูุช:

### 1. ุฅุตูุงุญ ุนุฑุถ ุงููุจุงูุบ (โ ุชู)
- ููุงุชูุฑ ุงูููุฏ ุชุนุฑุถ `totalAmount` ูุน ูุต "ูุงุชูุฑุฉ ูุดุชุฑูุงุช ููุฏ"
- ููุงุชูุฑ ุงูุฏูู ุชุนุฑุถ `totalAmount` ูุน ูุต "ูุงุชูุฑุฉ ูุดุชุฑูุงุช ุขุฌู"
- ุณูุฏุงุช ุงููุจุถ ุชุนุฑุถ `totalAmount` ูุน ูุต "ุณูุฏ ูุจุถ"

### 2. ุชุญุณูู ุญุณุงุจ ุงูุฃุฑุตุฏุฉ (โ ุชู)
- ุงูุญุณุงุจ ูุจุฏุฃ ูู ุตูุฑ ููุชุฑุงูู ุจุดูู ุชุฏุฑูุฌู
- ูู ูุนุงููุฉ ุชุญุตู ุนูู ุฑุตูุฏ "ูุจู" ู"ุจุนุฏ" ุจุดูู ุตุญูุญ
- ุฅุถุงูุฉ ุชุณุฌูู ููุตู ูุชุชุจุน ุงูุญุณุงุจุงุช

### 3. ุฅุถุงูุฉ ุชุณุฌูู ููุตู (โ ุชู)
- ุทุจุงุนุฉ ุชูุงุตูู ูู ูุงุชูุฑุฉ ูุณูุฏ ูุจุถ ุนูุฏ ุงูุชุญููู
- ุทุจุงุนุฉ ุงูุฑุตูุฏ ูุจู ูุจุนุฏ ูู ูุนุงููุฉ
- ุชุญุฐูุฑ ุฅุฐุง ูุงู ููุงู ูุฑู ุจูู ุงูุฑุตูุฏ ุงููุญุณูุจ ูุงููุนูู

## ุฎุทูุงุช ุงูุชุดุฎูุต:

### ุงูุฎุทูุฉ 1: ุชุดุบูู ุงูุชุทุจูู
```bash
flutter run
```

### ุงูุฎุทูุฉ 2: ูุชุญ ุตูุญุฉ ุชูุงุตูู ููุฑุฏ
1. ุงุฐูุจ ุฅูู ูุงุฆูุฉ ุงูููุฑุฏูู
2. ุงุฎุชุฑ ููุฑุฏ ูุฏูู ููุงุชูุฑ ูุณูุฏุงุช ูุจุถ
3. ุฑุงูุจ Console/Debug Output

### ุงูุฎุทูุฉ 3: ุชุญููู ุงูุณุฌูุงุช
ุงุจุญุซ ุนู ูุฐู ุงูุฑุณุงุฆู ูู Console:

```
๐ ุชุญุฏูุซ ุจูุงูุงุช ุงูููุฑุฏ [ุงุณู ุงูููุฑุฏ]...
๐ ุนุฏุฏ ุงูููุงุชูุฑ: X
  ๐ ูุงุชูุฑุฉ [ID]: [ุฑูู], [ูุจูุบ] ุฏููุงุฑ, ููุน: [ููุฏ/ุฏูู]
๐ ุนุฏุฏ ุณูุฏุงุช ุงููุจุถ: Y
  ๐ฐ ุณูุฏ [ID]: [ุฑูู], [ูุจูุบ] ุฏููุงุฑ, ุชุงุฑูุฎ: [ุชุงุฑูุฎ]
๐ฐ ุงูุฑุตูุฏ ุงูุญุงูู: [ุฑุตูุฏ]
```

```
๐ข ุญุณุงุจ ุงูุฃุฑุตุฏุฉ...
๐ ุนุฏุฏ ุงูููุงุชูุฑ: X
  โ ูุงุชูุฑุฉ [ID]: ููุน=[ููุน], ูุจูุบ=[ูุจูุบ], ูุฏููุน=[ูุฏููุน], ุชุฃุซูุฑ=[ุชุฃุซูุฑ]
๐ ุนุฏุฏ ุณูุฏุงุช ุงููุจุถ: Y
  โ ุณูุฏ [ID]: ูุจูุบ=[ูุจูุบ], ุชุฃุซูุฑ=[ุชุฃุซูุฑ]
๐ ุฅุฌูุงูู ุงููุนุงููุงุช: Z
  ๐ ูุงุชูุฑุฉ [ID]: ูุจู=[ุฑุตูุฏ], ุชุบููุฑ=[ุชุบููุฑ], ุจุนุฏ=[ุฑุตูุฏ]
  ๐ฐ ุณูุฏ [ID]: ูุจู=[ุฑุตูุฏ], ุชุบููุฑ=[ุชุบููุฑ], ุจุนุฏ=[ุฑุตูุฏ]
๐ฐ ุงูุฑุตูุฏ ุงูููุงุฆู ุงููุญุณูุจ: [ุฑุตูุฏ]
๐ฐ ุงูุฑุตูุฏ ุงููุนูู ูู ุงููุงุนุฏุฉ: [ุฑุตูุฏ]
```

```
๐ ุจูุงุก ุณุฌู ุงููุนุงููุงุช...
๐ ุนุฏุฏ ุงูููุงุชูุฑ: X
  โ ูุงุชูุฑุฉ [ID]: [ููุน], [ูุจูุบ] ุฏููุงุฑ
๐ ุนุฏุฏ ุณูุฏุงุช ุงููุจุถ: Y
  โ ุณูุฏ ูุจุถ [ID]: [ูุจูุบ] ุฏููุงุฑ
๐ ุฅุฌูุงูู ุงููุนุงููุงุช ูู ุงูุณุฌู: Z
```

### ุงูุฎุทูุฉ 4: ุงูุชุญูู ูู ุงููุดุงูู

#### ุฅุฐุง ูุงูุช ุณูุฏุงุช ุงููุจุถ = 0:
- ุงููุดููุฉ: ูุง ุชูุฌุฏ ุณูุฏุงุช ูุจุถ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- ุงูุญู: ุฃุถู ุณูุฏ ูุจุถ ุฌุฏูุฏ ูู ุงูุฒุฑ "ุณูุฏ ูุจุถ ุฌุฏูุฏ"

#### ุฅุฐุง ูุงูุช ุณูุฏุงุช ุงููุจุถ > 0 ููู ูุง ุชุธูุฑ ูู ุงูุณุฌู:
- ุงููุดููุฉ: ุฎุทุฃ ูู ุฏุงูุฉ `_buildUnifiedTimeline`
- ุชุญูู ูู ุงูุณุฌูุงุช: ูู ุชุธูุฑ ุฑุณุงูุฉ "โ ุณูุฏ ูุจุถ"ุ

#### ุฅุฐุง ูุงู ุงูุฑุตูุฏ ุจุนุฏ ุงููุนุงููุฉ ุฎุงุทุฆ:
- ุชุญูู ูู ุงูุณุฌูุงุช: ูู ุงูุฑุตูุฏ "ูุจู" ู"ุจุนุฏ" ุตุญูุญุ
- ุชุญูู ูู "ุงูุชุฃุซูุฑ" ููู ูุนุงููุฉ
- ุชุญูู ูู ุงููุฑู ุจูู ุงูุฑุตูุฏ ุงููุญุณูุจ ูุงููุนูู

## ุงููููุงุช ุงููุนุฏูุฉ:
- `lib/screens/supplier_details_screen.dart`

## ุงูุชุญุฏูุซ ุงูุฃุฎูุฑ (ุฅุตูุงุญ ุงูุชุฑุชูุจ):
- โ ุฅุถุงูุฉ ุญูู `createdAt` ุฅูู `_Entry` ููุชุฑุชูุจ ุงูุตุญูุญ
- โ ุงูุชุฑุชูุจ ุงูุขู: ุฃููุงู ุญุณุจ ุชุงุฑูุฎ ุงููุนุงููุฉุ ุซุงููุงู ุญุณุจ ููุช ุงูุฅูุดุงุก
- โ ูุฐุง ูุถูู ุฃู ุงููุนุงููุงุช ุงูุชู ููุง ููุณ ุงูุชุงุฑูุฎ ุชูุฑุชุจ ุญุณุจ ููุช ุฅูุดุงุฆูุง ุงููุนูู

## ุงูููุฏ ุงูููู:

### ุญุณุงุจ ุชุฃุซูุฑ ุงููุงุชูุฑุฉ ุนูู ุงูุฏูู:
```dart
final remaining = inv.paymentType == 'ููุฏ' ? 0.0 : (inv.totalAmount - inv.amountPaid);
final delta = remaining < 0 ? 0.0 : remaining;
```

### ุญุณุงุจ ุชุฃุซูุฑ ุณูุฏ ุงููุจุถ ุนูู ุงูุฏูู:
```dart
delta: -r.amount  // ุณุงูุจ ูุฃูู ูุฎูุถ ุงูุฏูู
```

### ุญุณุงุจ ุงูุฑุตูุฏ ุงูุชุฏุฑูุฌู:
```dart
double runningBalance = 0.0;
for (final e in entries) {
  final before = runningBalance;
  final after = before + e.delta;
  // ุญูุธ before ู after
  runningBalance = after;
}
```

### ุงูุชุฑุชูุจ ุงูุตุญูุญ:
```dart
// ุชุฑุชูุจ ูู ุงูุฃุญุฏุซ ุฅูู ุงูุฃูุฏู ููุนุฑุถ
entries.sort((a, b) {
  // ุฃููุงู: ุญุณุจ ุชุงุฑูุฎ ุงููุนุงููุฉ (ุงูุฃุญุฏุซ ุฃููุงู)
  final c = b.dt.compareTo(a.dt);
  if (c != 0) return c;
  // ุซุงููุงู: ุญุณุจ ููุช ุงูุฅูุดุงุก (ุงูุฃุญุฏุซ ุฃููุงู)
  return b.createdAt.compareTo(a.createdAt);
});
```

### ููุงุฐุง ูุณุชุฎุฏู createdAtุ
- `id` ูู ุฌุฏุงูู ูุฎุชููุฉ (supplier_invoices ู supplier_receipts) ูุง ูููู ููุงุฑูุชูู
- `createdAt` ูู ููุช ุงูุฅูุดุงุก ุงููุนูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- ูุฐุง ูุถูู ุฃู ุงููุนุงููุงุช ุงูุชู ููุง ููุณ ุงูุชุงุฑูุฎ ุชูุฑุชุจ ุญุณุจ ููุช ุฅูุดุงุฆูุง

## ููุงุญุธุงุช:
- ููุงุชูุฑ ุงูููุฏ ูุง ุชุคุซุฑ ุนูู ุงูุฏูู (delta = 0)
- ููุงุชูุฑ ุงูุฏูู ุชุฒูุฏ ุงูุฏูู ุจููุฏุงุฑ (ุงููุจูุบ - ุงููุฏููุน)
- ุณูุฏุงุช ุงููุจุถ ุชุฎูุถ ุงูุฏูู ุจููุฏุงุฑ ุงููุจูุบ
- ุงูุชุฑุชูุจ: ูู ุงูุฃูุฏู ุฅูู ุงูุฃุญุฏุซ ููุญุณุงุจุ ูู ุงูุฃุญุฏุซ ุฅูู ุงูุฃูุฏู ููุนุฑุถ
